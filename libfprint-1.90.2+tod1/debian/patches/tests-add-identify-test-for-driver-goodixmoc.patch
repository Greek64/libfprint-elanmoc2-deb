From: "boger.wang" <boger@goodix.com>
Date: Sun, 13 Sep 2020 21:14:05 +0800
Subject: tests: add identify test for driver goodixmoc add identify ioctl
 file, modify custom.py add identify test

---
 tests/goodixmoc/custom.ioctl | 12 +++++++++++-
 tests/goodixmoc/custom.py    |  6 +++++-
 2 files changed, 16 insertions(+), 2 deletions(-)
 mode change 100644 => 100755 tests/goodixmoc/custom.py

diff --git a/tests/goodixmoc/custom.ioctl b/tests/goodixmoc/custom.ioctl
index 92d50f9..21c8531 100644
--- a/tests/goodixmoc/custom.ioctl
+++ b/tests/goodixmoc/custom.ioctl
@@ -290,7 +290,17 @@ USBDEVFS_REAPURBNDELAY 0 3 1 0 0 44 44 0 A50000392400847B00000000000000000000000
   USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 64 0 AA00007208002CD300A5000129052BF2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
     USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 192 0 A50000739300A15E005A632900000000640043010107000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E4650312D30303030303030302D302D30303030303030302D6E6F626F6479008B7767E4A81CC57C17A21C0F44B08232229E7F2E5DBFA70A5CEF58A3966ED710002FF9938030303030303030302D302D30303030303030302D6E6F626F6479008B7767E4A81CC57C17A2
-USBDEVFS_REAPURBNDELAY 0 3 1 0 0 114 114 0 A700003A6A00E619640043010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E4650312D30303030303030302D302D30303030303030302D6E6F626F6479007557A258
+USBDEVFS_REAPURBNDELAY 0 3 1 0 0 15 15 0 a200003a07007788010023107a86d3
+ USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
+  USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 64 0 AA0000700800FA0500A20001E14E401B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
+   USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
+    USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 64 0 A200007107001DE2005A635942221700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
+USBDEVFS_REAPURBNDELAY 0 3 1 0 0 44 44 0 a500003b240052ad0000000000000000000000000000000000000000000000000000000000000000828af704
+ USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
+  USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 64 0 AA00007208002CD300A5000129052BF2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
+   USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
+    USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 192 0 A50000739300A15E005A632900000000640043010107000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E4650312D30303030303030302D302D30303030303030302D6E6F626F6479008B7767E4A81CC57C17A21C0F44B08232229E7F2E5DBFA70A5CEF58A3966ED710002FF9938030303030303030302D302D30303030303030302D6E6F626F6479008B7767E4A81CC57C17A2
+USBDEVFS_REAPURBNDELAY 0 3 1 0 0 114 114 0 a700003c6a009b64640043010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e4650312d30303030303030302d302d30303030303030302d6e6f626f647900473c9b29
  USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
   USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 64 0 AA000074080051AE00A70001AC924B34000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    USBDEVFS_REAPURBNDELAY 0 3 131 0 0 2048 0 0 
diff --git a/tests/goodixmoc/custom.py b/tests/goodixmoc/custom.py
old mode 100644
new mode 100755
index 56dc16c..6cc3b70
--- a/tests/goodixmoc/custom.py
+++ b/tests/goodixmoc/custom.py
@@ -22,7 +22,7 @@ template = FPrint.Print.new(d)
 def enroll_progress(*args):
     print('enroll progress: ' + str(args))
 
-# List, enroll, list, verify, delete
+# List, enroll, list, verify, identify, delete
 print("enrolling")
 p = d.enroll_sync(template, None, enroll_progress, None)
 print("enroll done")
@@ -36,6 +36,10 @@ print("verifying")
 verify_res, verify_print = d.verify_sync(p)
 print("verify done")
 assert verify_res == True
+print("identifying")
+identify_match, identify_print = d.identify_sync(stored)
+print("identify done")
+assert identify_match.equal(identify_print)
 
 print("deleting")
 d.delete_print_sync(p)
